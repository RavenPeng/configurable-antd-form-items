"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var React=_interopDefault(require("react")),antd=require("antd");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var UploadImage=function(e){function t(){var e;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))),"handleCancel",function(){return e.setState({previewVisible:!1})}),_defineProperty(_assertThisInitialized(e),"handlePreview",function(t){e.setState({previewImage:t.url||t.thumbUrl,previewVisible:!0})}),_defineProperty(_assertThisInitialized(e),"handleChange",function(t){e.props.saveImgUrl(t),t.fileList[0].status="done",e.setState({fileList:t.fileList})}),_defineProperty(_assertThisInitialized(e),"clearImage",function(){e.setState({fileList:[]}),e.props.onRemove&&e.props.onRemove()}),e.state={previewVisible:!1,previewImage:"",fileList:[]},e}return _inherits(t,React.PureComponent),_createClass(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,r=e.fileList,n=this.props,o=n.actionPath,i=n.name,l=React.createElement("div",null,React.createElement(antd.Icon,{type:"plus"}),React.createElement("div",{className:"ant-upload-text"},"Upload"));return React.createElement("div",{className:"clearfix"},React.createElement(antd.Upload,{action:o,listType:"picture-card",fileList:r,onPreview:this.handlePreview,onChange:this.handleChange,name:i,accept:"image/*",onRemove:this.clearImage},r.length>=1?null:l),React.createElement(antd.Modal,{visible:t,footer:null,onCancel:this.handleCancel},React.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.isDeleteFile&&(t.fileList=[]),t}}]),t}(),Option=antd.Select.Option,TextArea=antd.Input.TextArea,Search=antd.Input.Search,RangePicker=antd.DatePicker.RangePicker,RadioGroup=antd.Radio.Group,FormItems=function(e){function t(){var e,a;_classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return _defineProperty(_assertThisInitialized(a=_possibleConstructorReturn(this,(e=_getPrototypeOf(t)).call.apply(e,[this].concat(n)))),"getUploadFileUrl",function(e,t,r){var n=e.fileList.slice(-2);n=(n=n.map(function(e){return e.response&&(e.url=e.response.data),e})).filter(function(e){return!!e.response&&(a.props.form.setFieldsValue(_defineProperty({},t,e.response.data)),r&&r(),e)})}),_defineProperty(_assertThisInitialized(a),"getItem",function(e){switch(e.type){case"upload":return React.createElement(antd.Upload,{name:e.name||"file",action:e.actionPath,headers:{authorization:"authorization-text"},onChange:function(t){return a.getUploadFileUrl(t,e.key,e.onChange)},accept:e.accept,disabled:e.disabled,onRemove:e.onRemove},React.createElement(antd.Button,null,React.createElement(antd.Icon,{type:"upload"}),e.text||"Select File"));case"uploadImg":return React.createElement(UploadImage,{actionPath:e.actionPath,saveImgUrl:function(t){return a.getUploadFileUrl(t,e.key,e.onChange)},isDeleteFile:e.isDeleteFile,name:e.name,onRemove:e.onRemove});case"dateTime":return React.createElement(antd.DatePicker,{showTime:!0,style:{width:"100%"},disabledDate:e.disabledDate,disabledTime:e.disabledTime});case"dateRange":return React.createElement(RangePicker,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:e.placeholder||["Start Time","End Time"],onChange:e.onChange,onOk:e.onOk,allowClear:e.allowClear});case"radio":return React.createElement(RadioGroup,{disabled:e.disabled},e.radio.map(function(e){return React.createElement(antd.Radio,{value:e.value,key:e.value},e.text)}));case"select":return React.createElement(antd.Select,{placeholder:e.placeholder,disabled:e.disabled,onChange:e.onChange,showSearch:e.showSearch,optionFilterProp:e.optionFilterProp,filterOption:e.filterOption,allowClear:e.allowClear,mode:e.mode,maxTagCount:e.maxTagCount,className:e.className},e.options.map(function(e){return e.text||(e.text=e.value),React.createElement(Option,{value:e.value,key:e.value},e.text)}));case"textArea":return React.createElement(TextArea,{autosize:{minRows:e.size},maxLength:e.maxLength,disabled:e.disabled,onBlur:e.onBlur});case"number":return React.createElement(antd.InputNumber,{min:e.min,max:e.max,step:e.step,onChange:e.onChange,placeholder:e.placeholder,className:e.className});case"btn":return React.createElement(antd.Button,{type:e.btnType||"primary",loading:e.loading,onClick:e.onClick,disabled:e.disabled},e.text);case"search":return React.createElement(Search,{placeholder:e.placeholder,enterButton:e.enterButtonText,size:e.size||"large",onSearch:e.onSearch});case"check":return React.createElement(antd.Checkbox.Group,null,e.box.map(function(e,t){return React.createElement(antd.Checkbox,{value:e.value,key:t},e.text)}));case"component":return e.component;default:return React.createElement(antd.Input,{placeholder:e.placeholder,maxLength:e.maxLength,type:e.inputType,disabled:e.disabled,onBlur:e.onBlur})}}),_defineProperty(_assertThisInitialized(a),"getForm",function(e){if(a.props.form){var t=a.props.form.getFieldDecorator;return e.map(function(e,r){var n=e.label,o=e.key,i=e.required,l=e.extra,c=e.initialValue,s=e.rules,u=void 0===s?[]:s,p=e.slot,d=e.isShowSlot,m=e.toggler,f=void 0===m||m;return i&&(u=[].concat(_toConsumableArray(u),[{required:!0,message:"please add the ".concat(n||"value",".")}])),React.createElement("span",{className:"item-wrapper",key:r},f?React.createElement(antd.Form.Item,{label:n,key:r,extra:l,className:e.className},d?p:null,o?t(o,{initialValue:c,rules:u})(a.getItem(e)):a.getItem(e)):null)})}}),a}return _inherits(t,React.PureComponent),_createClass(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.needInit,a=e.data,r=e.form;t&&Object.keys(a).forEach(function(e){return setTimeout(function(){return r.setFieldsValue(_defineProperty({},e,a[e]))},0)})}},{key:"render",value:function(){return React.createElement("div",{className:"form-wrapper"},this.getForm(this.props.formItems))}}]),t}();module.exports=FormItems;
